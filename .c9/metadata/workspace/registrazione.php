{"changed":true,"filter":false,"title":"registrazione.php","tooltip":"/registrazione.php","value":"<!DOCTYPE html>\n\n<?php\ninclude('cuore.php');\n?>\n\n<html>\n\n    <head>\n        <meta charset=\"utf-8\"/>\n        <link rel=\"stylesheet\" type=\"text/css\" href=\"mystyle.css\" media=\"screen\">\n    </head>\n<body>\n    <div id=\"formattazione_testo\">\n    <h4>\n    <?php\n\n    $username=$_POST['username'];\n    $nome=$_POST['nome'];\n    $cognome=$_POST['cognome'];\n    $usermail=$_POST['usermail'];\n    $pswd=$_POST['pswd'];\n\n    //session_start();\n    //\n    //$ip =  \"0.0.0.0\";\n    //$port = \"3306\";\n    //$user = \"yukumura\";\n    //$db = \"c9\";\n \n    //$mysqli = new mysqli();\n    //$mysqli->connect($ip, $user, '', $db);    \n\n////////////////////////////////////////////////////////////////////////////\n$query=\"SELECT COUNT(*) as total FROM iscritti WHERE username LIKE '$username'\";\n\n$result = $mysqli->query($query);\n$row = $result->fetch_assoc();\n//echo $row['total']. \" corrispondenze trovate <br>\";\n\nif($row['total']!=0){\n    echo \"$username è già utilizzato. Riprova.<br>\";\n}\n////////////////////////////////////////////////////////////////////////////\n//$query=\"SELECT COUNT(*) as total FROM iscritti WHERE nome='$nome' AND cognome='$cognome'\";\n//    \n//$result = $mysqli->query($query);\n//$row = $result->fetch_assoc();\n//echo $row['total']. \" corrispondenze trovate <br>\";\n//\n//if($row['total']!=0){\n//   echo \"Esiste già un $nome $cognome. Sicuro di non esserti già registrato? <br>\";\n//   $errore=1;\n//}else{\n//    echo \"Nome e cognome ok.<br>\";\n//    $errore=0;\n//}\n////////////////////////////////////////////////////////////////////////////\n$query=\"SELECT COUNT(*) as total FROM iscritti WHERE email='$usermail'\";\n\n$result = $mysqli->query($query);\n$row = $result->fetch_assoc();\n//echo $row['total']. \" corrispondenze trovate <br>\";\n\nif($row['total']!=0){\n   echo \"La mail che hai inserito è già utilizzata. Riprova.<br>\";\n   $errore=1;\n}else $errore=0;\n\n\nif($errore==0){\n    \n    /* set autocommit to off */\n    $mysqli->autocommit(false);\n    \n    $pswd = md5($pswd);\n    $query=\"INSERT INTO iscritti (nome, cognome, username, password, email)\n    VALUES ('$nome', '$cognome', '$username', '$pswd', '$usermail')\";\n\n    //lancio la  query\n    $result = $mysqli->query($query);\n    \n    //transazione commit\n    if (!$mysqli->commit()) {\n    echo \"Transazione fallita <br>\";\n    exit();\n    }\n    \n    echo \"Registrazione effettuata. Benvenuto/a $nome $cognome alias $username. Adesso puoi inserire le tue esperienze nella sezione apposita del sito.<br><br>\";\n}else{\n    echo \"La registrazione non è andata a buon termine.<br><br>\";\n}\n\n    $mysqli->autocommit(true);\n\n\n//if ($result = $mysqli->query(\"SELECT * FROM iscritti LIMIT 10\")) {\n//    printf(\"Select returned %d rows.\\n\", $result->num_rows);\n//}else printf(\"Error message: %s\\n\", $mysqli->error);\n// chiudo la connessione a MySQL\n\n    $mysqli->close();\n    header(\"refresh:3;url='index.php'\");\n    echo \"<form><input type=\\\"button\\\" onclick=\\\"window.location='home.php'\\\" value=\\\"Ritorna alla Home\\\"></form>\";\n?>\n</h4>\n</div>\n</body>\n</html>","undoManager":{"mark":-1,"position":7,"stack":[[{"group":"doc","deltas":[{"start":{"row":102,"column":27},"end":{"row":102,"column":28},"action":"remove","lines":["h"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":27},"end":{"row":102,"column":28},"action":"remove","lines":["o"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":27},"end":{"row":102,"column":28},"action":"remove","lines":["m"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":27},"end":{"row":102,"column":28},"action":"remove","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":27},"end":{"row":102,"column":28},"action":"insert","lines":["i"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":28},"end":{"row":102,"column":29},"action":"insert","lines":["n"]},{"start":{"row":102,"column":29},"end":{"row":102,"column":30},"action":"insert","lines":["d"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":30},"end":{"row":102,"column":31},"action":"insert","lines":["e"]}]}],[{"group":"doc","deltas":[{"start":{"row":102,"column":31},"end":{"row":102,"column":32},"action":"insert","lines":["x"]}]}]]},"ace":{"folds":[],"scrolltop":879.25,"scrollleft":0,"selection":{"start":{"row":77,"column":32},"end":{"row":77,"column":32},"isBackwards":true},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":242,"mode":"ace/mode/php"}},"timestamp":1417626384224}